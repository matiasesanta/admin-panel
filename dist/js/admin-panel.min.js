/*! admin-panel 2017-06-27 */

angular.module("adminPanel",["ngAnimate"]),angular.module("adminPanel").directive("apAccordion",function(){return{require:"ngModel",restrict:"AE",transclude:!0,scope:{allowAllClosed:"=",multiExpand:"=",addButtonText:"@?",name:"@?"},link:function(e,n,t,i){n.addClass("ap-accordion"),e.accordion=new Foundation.Accordion(n.find(".accordion"),{"data-multi-expand":e.multiExpand,"data-allow-all-closed":e.allowAllClosed}),e.addElement=function(){var n={},t=e.name?e.name:"default";e.$emit("ap.accordion.add",n,t),i.$modelValue.push(n)},e.removeElement=function(n){e.$emit("ap.accordion.remove",n);var t=i.$modelValue,o=t.indexOf(n);o>-1&&t.splice(o,1)}},controller:["$scope",function(e){this.toggleTab=function(n){e.accordion.$element.foundation("toggle",n)},this.removeElement=function(n){e.removeElement(n)},this.reInitComponent=function(){e.accordion.$element.foundation("up",e.accordion.$tabs.find(".accordion-content")),Foundation.reInit(e.accordion.$element)}}],templateUrl:"directives/accordion/accordion.template.html"}}),angular.module("adminPanel").directive("apAccordionItem",function(){return{require:["^^apAccordion","ngModel"],restrict:"AE",transclude:!0,scope:{itemTitle:"@?",itemTitleFunc:"=?",deleteButton:"=?"},link:function(e,n,t,i){e.title="hola",t.$set("dataAccordionItem",""),n.addClass("accordion-item is-active"),i[0].reInitComponent(),e.deleteElement=function(){i[0].removeElement(i[1].$modelValue)},e.toggleTab=function(){i[0].toggleTab(n.find(".accordion-content"))},void 0===e.itemTitle?e.$watch(e.itemTitleFunc,function(n){console.log("title",n),e.title=n}):(console.log("itemtitle",e.itemTitle),e.title=e.itemTitle)},templateUrl:"directives/accordion/accordionItem.template.html"}}),angular.module("adminPanel").directive("apBox",["$rootScope",function(e){return{restrict:"AE",transclude:!0,scope:{title:"@",closeButton:"=?",closeIf:"=?",init:"&?"},link:function(n,t,i){t.addClass("ap-box"),n.closeIf=!1,n.elem=t,n.close=function(){n.closeIf=!0},t.on("mouseenter",function(){n.elem.removeClass("no-visible"),e.$broadcast("box.directive.mouseenter",n.elem)}),n.$on("box.directive.mouseenter",function(e,t){n.elem!==t&&n.elem.addClass("no-visible")}),n.$watch(function(){return n.closeIf},function(e){e?t.hide():t.show()}),n.init&&n.init()},templateUrl:"directives/box/box.template.html"}}]),angular.module("adminPanel").directive("apDateTimePicker",["$timeout",function(e){return{restrict:"AE",require:"ngModel",scope:{format:"@?"},link:function(n,t,i,o){function a(t,i,a){var l=null!==i||void 0!==i?i:n.hours,c=null!==a||void 0!==a?a:n.minutes;t.setSeconds(0),t.setHours(l),t.setMinutes(c),e(function(){n.$apply(function(){o.$setViewValue(t)})},100)}t.addClass("row collapse date ap-datetimepicker"),n.hours=0,n.minutes=0,n.date=new Date;var l={format:"dd/mm/yyyy",initialDate:n.date};n.$watch(function(){return o.$modelValue},function(e){if(e){var i=new Date(e);n.date=i,$(t.find(".ap-date")).fdatepicker("update",i),n.hours=i.getHours(),n.minutes=i.getMinutes()}}),$(t.find(".ap-date")).fdatepicker(l).on("changeDate",function(e){n.date=e.date,n.date.setHours(n.date.getHours()+n.date.getTimezoneOffset()/60),a(n.date,null,null)}),n.changeHour=function(){n.hours<0&&(n.hours=0),n.hours>23&&(n.hours=23),a(n.date,n.hours,n.minutes)},n.changeMinute=function(){n.minutes<0&&(n.minutes=0),n.minutes>59&&(n.minutes=59),a(n.date,n.hours,n.minutes)}},templateUrl:"directives/dateTimePicker/dateTimePicker.template.html"}}]),angular.module("adminPanel").directive("apLoad",function(){return{restrict:"A",transclude:!0,scope:{},link:function(e,n,t){n.addClass("ap-load"),e.loading=!1,e.show=function(n){e.loading=!1,e.message=n},e.hide=function(){e.loading=!0},e.$on("apLoad:finish",function(n,t){e.show(t)}),e.$on("apLoad:start",function(){e.hide()})},controller:function(e){this.show=function(n){e.show(n)},this.hide=function(){e.hide()}},templateUrl:"directives/load/load.template.html"}}),angular.module("adminPanel").directive("apSelect",["$timeout",function(e){return{restrict:"AE",scope:{reosource:"=",search:"=?",names:"=",model:"=",onChange:"&?"},link:function(n,t,i){n.menuOpen=!1,n.loading=!0,n.dropdownContainer=t.find(".dropdown-ap"),n.inputElem=t.find("input"),t.addClass("select-ap"),n.request=null,n.input="",n.onInputChange=function(e){var t=n.search||{};if(!e)for(var i=0;i<n.names.length;i++)t[n.names[i]]=n.input;n.loading=!0,n.request&&n.request.$cancelRequest(),n.request=n.reosource.get(t,function(e){n.loading=!1;var t=e.data;n.options=[];for(var i=0;i<t.length;i++){for(var o="",a=0;a<n.names.length;a++)o+=t[i][n.names[a]]+", ";o=o.replace(/,\s*$/,""),n.options.push({name:o,id:t[i].id})}})},n.optionSelected=function(t){n.model=t,e(function(){n.input=t.name},50)},n.buttonClick=function(){n.menuOpen=!n.menuOpen,n.menuOpen&&n.onInputChange(!0)},n.onFocus=function(){n.menuOpen=!0},n.onBlur=function(){e(function(){n.menuOpen=!1},100)},n.$watch(function(){return n.menuOpen},function(e){e?(n.inputElem.focus(),n.dropdownContainer.addClass("is-open")):n.dropdownContainer.removeClass("is-open")}),n.$watch(function(){return n.model},function(e){void 0!==n.onChange&&n.onChange({option:e});var t="";if(e){for(var i=0;i<n.names.length;i++)t+=e[n.names[i]]+", ";t=t.replace(/,\s*$/,"")}n.input=t})},templateUrl:"directives/select/select.template.html"}}]),angular.module("adminPanel").filter("highlight",["$sce",function(e){return function(n,t){return t&&(n=n.replace(new RegExp("("+t+")","gi"),'<span class="highlighted">$1</span>')),e.trustAsHtml(n)}}]),angular.module("adminPanel").run(["$templateCache",function(e){e.put("directives/accordion/accordion.template.html",'<div ng-if=addButtonText class="row column"><button type=button class="button secondary" ng-click=addElement() ng-bind=addButtonText></button></div><div class=accordion ng-transclude></div>'),e.put("directives/accordion/accordionItem.template.html",'<div class=accordion-top><button type=button class=accordion-title ng-click=toggleTab() ng-bind=title></button><div class=accordion-button><button type=button ng-if=deleteButton class="button alert" ng-click=deleteElement()><i class="fa fa-remove"></i></button></div></div><div class=accordion-content data-tab-content ng-transclude></div>'),e.put("directives/box/box.template.html","<div class=card><button ng-if=closeButton class=close-button type=button ng-click=close()><span>&times;</span></button><div class=card-divider><h5 ng-bind=title></h5></div><div class=card-section ap-load><div ng-transclude></div></div></div>"),e.put("directives/dateTimePicker/dateTimePicker.template.html",'<div class=input-group><span class="input-group-label prefix"><i class="fa fa-calendar"></i></span> <input class="input-group-field ap-date" readonly> <span class=input-group-label>Hs</span> <input class=input-group-field type=number style="width: 60px" ng-model=hours ng-change=changeHour()> <span class=input-group-label>Min</span> <input class=input-group-field type=number style="width: 60px" ng-model=minutes ng-change=changeMinute()></div>'),e.put("directives/load/load.template.html","<div ng-show=loading class=ap-load-image><img src=img/ring.svg></div><div ng-hide=loading class=ap-load-content><div ng-if=message class=callout ng-class=\"{\n        'success':message.type === 'success',\n        'warning':message.type === 'warning',\n        'alert':message.type === 'error'\n    }\" ng-bind=message.message></div><div ng-transclude></div></div>"),e.put("directives/select/select.template.html",'<div class=input-group><input class=input-group-field ng-model=input ng-change=onInputChange() ng-focus=onFocus() ng-blur=onBlur()><div class=input-group-button><button type=button class="button secondary" ng-click=buttonClick()><span class=caret></span></button></div></div><div class=dropdown-ap><ul ng-if=loading class=list-group><li style="font-weight: bold">Cargando...</li></ul><ul ng-if="!loading && options.length > 0" class=list-group><li ng-repeat="option in options" ng-bind-html="option.name | highlight:input" ng-click=optionSelected(option)></li></ul><ul ng-if="!loading && options.length === 0" class=list-group><li style="font-weight: bold">No hay resultados</li></ul></div>')}]);